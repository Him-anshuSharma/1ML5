import os
import sys
from transformers import AutoTokenizer, AutoModelForSequenceClassification, pipeline

# Make sure we can import constants.py from parent folder
sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..')))
# from constants import journals  # This should be a list of journal texts

journals = [
    """Today was one of those rare days where everything seemed to flow effortlessly. I woke up earlier than usual, not because I had to, but because I wanted to watch the sunrise. The golden light spilled through my curtains, painting my room in a soft, warm glow. I made a slow breakfast — scrambled eggs, toast with butter, and freshly brewed coffee — and enjoyed it while reading the last chapter of the novel I had been savoring for weeks. By mid-morning, I decided to take a long walk in the park. The air smelled fresh from last night’s rain, and the leaves shimmered with droplets like tiny jewels. I passed by the playground where children’s laughter rang out, pure and unfiltered, and felt an inexplicable surge of joy. At one point, I sat on a bench and watched a pair of squirrels chase each other, their playful energy contagious. In the afternoon, I worked on my art project — a watercolor painting of the very park I had just visited. The brush strokes seemed to flow with ease today, and I lost track of time in that meditative state of creation. Evening came quietly, with a soft orange sky fading into a deep indigo. I cooked pasta for dinner, lit a candle, and listened to my favorite jazz playlist. Before bed, I journaled about the day, trying to capture the serenity I felt, hoping I could revisit this feeling when life gets chaotic again.""",

    """I’m exhausted — mentally, physically, emotionally. The past few weeks have been an endless cycle of work, deadlines, and obligations that seem to multiply no matter how much I get done. Today was no exception. I woke up late because I was up until 2 a.m. finishing a report for work. The moment I opened my laptop, the flood of unread emails and meeting invites hit me like a wave. I barely had time to eat, and even my coffee felt rushed. Midday, a project update meeting turned into a two-hour grilling session where every small mistake was magnified. I tried to defend myself, but the constant interruptions and passive-aggressive comments wore me down. By the time the meeting ended, my hands were trembling with frustration. I took a short break, staring out the window at the grey, overcast sky, wondering if this is all worth it. In the evening, I forced myself to attend a friend’s dinner invitation, but even there, my mind was half on work. I laughed when appropriate, nodded when someone spoke, but inside, I just wanted to go home. Now I’m back in my room, laptop open again, answering more emails. My body aches, my eyes sting, and I can’t remember the last time I felt truly rested. I keep telling myself things will slow down soon, but I’m starting to doubt it.""",

    """It’s been exactly a year since you left, and the ache hasn’t dulled one bit. I tried keeping busy today, filling every hour with chores and meaningless errands, but grief has a way of seeping through the cracks. This morning, I cleaned out the closet and found your old sweater — the one you used to wear when we stayed up late talking. The scent is faint now, but it’s still there, enough to bring tears to my eyes. I thought about donating it, but I couldn’t. Not yet. I went to the café we used to love, sat in our corner table, and ordered your favorite drink. I watched couples walk in and out, laughing, sharing bites of cake, and felt that familiar heaviness settle in my chest. The barista, who still remembers us, asked how I’ve been. I smiled and said I’m doing okay. A lie, but easier than explaining. Tonight, I lit a candle in your memory, placed it by the window, and let it burn as I scrolled through our old photos. Each picture was a reminder of the joy, the love, the comfort you brought into my life. People keep telling me time will heal, but I’m starting to think it just teaches you to carry the weight more quietly.""",

    """I can’t believe how quickly things escalated today. It started with a minor disagreement about the budget for our trip — something I thought we could discuss calmly. But within minutes, voices were raised, accusations were thrown, and suddenly it wasn’t about the trip anymore. We were rehashing old arguments, bringing up things from months ago that should have been left in the past. I could feel my chest tightening, my hands clenching into fists, and before I knew it, I was shouting. I hate shouting. It leaves me feeling raw and drained, and yet, in the moment, I couldn’t stop. When you slammed the door and walked out, I just stood there, trembling, wondering how we keep ending up here. Hours passed before you texted, just one line: “I need space.” I didn’t reply. I didn’t know what to say. Now, the apartment feels too quiet, every creak in the walls amplified. I keep replaying the fight in my head, wondering if I could have handled it differently. Part of me wants to apologize, part of me wants you to apologize first, and another part just wants this tension to disappear. I don’t know what tomorrow will bring, but I do know I’m tired of living in this cycle.""",

    """I had my first day at the new job today, and it was a whirlwind of emotions. Walking into the office felt like stepping onto a stage where everyone already knew their roles, and I was the newcomer fumbling through the script. The morning was filled with introductions, handshakes, and names I knew I’d forget by tomorrow. My manager seemed friendly enough, though I couldn’t shake the feeling I was being evaluated with every move. By lunch, I was sitting alone in the break room, pretending to scroll through my phone while wishing someone would invite me to join their table. In the afternoon, I shadowed a colleague who explained the systems we use. Half the time, I nodded along while internally panicking at how much there was to learn. Still, there were moments of excitement — like when I figured out how to navigate the database on my own. By the end of the day, I was drained but oddly hopeful. Maybe this will get easier. Maybe I’ll find my place here. For now, I’ll take it one day at a time, even if it means eating lunch alone for a while.""",

    """Today was magical in a way I didn’t expect. I went hiking in the hills just outside the city, and the weather was perfect — crisp air, golden sunlight filtering through the trees, the faint sound of a stream somewhere nearby. I started the trail with music playing through my headphones but soon took them off, realizing the forest had its own symphony. Birds calling, leaves crunching under my boots, the occasional rustle of a squirrel darting past. Halfway up, I came across a clearing where the view stretched for miles — rolling hills, a patchwork of fields, and a distant lake glinting like glass. I sat there for over an hour, sketching the scene in my notebook, feeling completely at peace. On the way back down, I ran into an older couple who had been hiking the same trail for decades. We chatted about the changing seasons, and they shared stories about how the place looked in winter. By the time I reached my car, the sun was setting, painting the horizon in orange and pink. I drove home with the windows down, the cool air on my face, carrying a sense of calm that I wish I could bottle and keep forever.""",

    """It’s been one of those days where everything seemed to go wrong at once. First, I spilled coffee all over my white shirt before I even left the house. Then, the bus was late, making me 20 minutes late for work. My manager wasn’t happy, and I could feel the tension in the room all morning. Around noon, I got a call from the vet — my cat needs a dental procedure that’s going to cost way more than I can afford right now. That news hit me hard, but I didn’t have time to process because I had to run to a meeting. The meeting was chaotic, with everyone talking over each other, and I left feeling more drained than before. By the time I got home, the sky had opened up and rain was pouring down. I sat by the window, watching it fall, and let myself cry for the first time in weeks. It wasn’t just about today — it was about everything I’ve been bottling up. Eventually, I made tea, curled up under a blanket, and put on a comfort show. Small steps toward feeling okay again.""",

    """This evening was unlike anything I’ve experienced before. A friend invited me to a rooftop poetry reading, and though I was hesitant at first, I’m glad I went. The city skyline at night was breathtaking, the lights twinkling like stars. We sat on mismatched chairs under strings of fairy lights, listening to strangers pour their hearts out through verse. Some poems were funny, others heartbreaking, and a few so raw they made my chest ache. One poet spoke about losing their mother, and the silence that followed was heavy yet comforting, as if we were all holding that grief together. After the readings, we mingled over wine and snacks. I met people from all walks of life — artists, teachers, students — each with a story to tell. I left feeling inspired, my mind buzzing with words I wanted to write down. On the way home, I walked slowly, letting the cool night air wrap around me. It felt like the world was softer somehow, like I was seeing it through a different lens.""",

    """I’ve been feeling restless lately, so today I decided to do something spontaneous — I booked a train ticket to a nearby coastal town I’d never visited before. The ride was peaceful, fields and small villages passing by in a blur. When I arrived, the salty air and sound of waves instantly lifted my mood. I walked along the beach, letting the cold water lap at my feet, collecting seashells like I used to as a kid. I had lunch at a small café with ocean views, savoring fresh seafood and a glass of lemonade. In the afternoon, I explored the narrow streets lined with pastel houses and local shops. I bought a handmade bracelet from a friendly shop owner who told me about the town’s history. As the sun began to set, I climbed a small hill overlooking the harbor, watching the sky shift through shades of orange, pink, and purple. I caught the last train home, tired but happy, feeling like I had stepped into another world, even if just for a day.""",

    """The anxiety has been creeping up again, and today it hit hard. I had planned to spend the day working on my thesis, but every time I sat down to write, my mind would race with intrusive thoughts. I tried all my usual coping mechanisms — deep breathing, making tea, even going for a walk — but nothing seemed to quiet the noise. By afternoon, I was curled up on the couch, scrolling aimlessly on my phone, feeling both restless and drained. Friends texted to ask if I wanted to hang out, but I made excuses. The thought of socializing felt overwhelming. In the evening, I forced myself to write at least one page, just to feel like I’d done something. It wasn’t good, but it was something. Now, as I lie in bed, the weight in my chest hasn’t lifted. I know tomorrow might be better, but tonight, it’s hard to see past the fog."""
]


tricky_journals = [
    # 1 — Mixed joy & sadness
    """Today was my graduation day. The hall was filled with flowers, banners, and the excited chatter of friends in their caps and gowns. My family sat in the front row, smiling and clapping when my name was called. For a moment, I felt so proud, so full of joy that I could burst. Yet, as the ceremony ended and people drifted into clusters for photos, I noticed the empty space where my grandmother would have been. She always said she would see me walk that stage. I smiled for every camera, but my eyes felt heavy, and the laughter in my throat was caught somewhere between celebration and loss. The world applauded, and inside me, two currents ran — one warm and golden, the other dark and aching.""",

    # 2 — Subtle anger disguised as politeness
    """I received yet another email from Mark this morning, apologizing for missing our meeting — the third time this month. He wrote, 'So sorry, something urgent came up again.' I replied with a short, 'No problem, let’s reschedule.' But my fingers were stiff on the keyboard, and my chest tightened as I hit send. It’s strange how the words we choose can be so polite while holding back an entire storm. I imagined him sitting comfortably at home while I rearranged my entire schedule, again. I don’t yell, I don’t snap, but every time it happens, the quiet frustration digs a little deeper. I wonder if he even notices.""",

    # 3 — Fear vs anxiety vs excitement
    """Tomorrow, I’m going on my first solo trip abroad. My suitcase is already packed, documents in a neat folder, but my hands won’t stop fidgeting. I picture the airport, the crowd, the boarding gates — and my heart races. There’s excitement, sure. I’ve been dreaming about this trip for years. But then, images of missed flights, lost passports, and confusing signs in foreign languages flood in. I keep checking my itinerary as if it might suddenly change. Mom says I’ll be fine, but I can’t decide if the knot in my stomach is pure fear or the kind of nervous thrill people chase when they do something brave.""",

    # 4 — Joy overshadowed by guilt
    """The project I’ve been working on for months finally got approved today. Everyone in the office congratulated me, and the manager said my work was exceptional. At lunch, I treated myself to my favorite dessert and even bought flowers for my desk. Still, every time I thought about celebrating, my mind wandered to Sarah. She worked just as hard, maybe harder, but her proposal didn’t make it past the first review. She smiled at me when I shared the news, but there was something dim in her eyes. I keep wondering if I should have done more to help her, or if my success somehow came at her expense. It’s hard to feel purely happy when someone else’s light dims next to yours.""",

    # 5 — Neutral with hidden melancholy
    """I spent the afternoon reorganizing my bookshelf. The dust on the top shelf made me sneeze, and I found a few books I had forgotten I owned. The sun shifted across the living room as I sorted them by color, then by size, then by genre. Outside, children played in the street, their laughter faint but persistent. I made a cup of tea and sat on the couch, looking at the shelves now perfectly aligned. Everything was tidy, quiet, and still. Yet, there was a faint tug in my chest — not sadness exactly, but a sense of something missing. I couldn’t name it, but it lingered even after I turned on the TV."""
]

stress_test_journals = [
    # 1: Frustration without surprise
    """I arrived at the café exactly at 3 p.m., as we had planned. I ordered a coffee, found a quiet table by the window, and waited. By 3:20, my cup was empty. I sent a quick message: 'On your way?' No reply. At 3:40, I packed my things and left. This is the fourth time this month she’s cancelled without notice. I didn’t slam the door, didn’t send an angry text, but the walk home felt heavier with each step. Some people apologize. Some just disappear.""",

    # 2: Excitement without fear
    """Tomorrow, I finally get to see the band I’ve loved since high school. I bought the tickets months ago and even planned my outfit. Tonight, I’ll probably stay up picking out which shoes go best with the jacket. I’ve watched every live performance online, but nothing compares to hearing them in person. The thought of singing along with thousands of others gives me chills — the good kind. I’m not nervous. Just impatient, in the best way.""",

    # 3: Completely neutral
    """This morning, I woke up at 7:15. I made oatmeal with bananas and honey, then watered the plants on the balcony. The sun was already warm, and a light breeze moved the curtains in the living room. I spent most of the day sorting digital files, deleting old screenshots, and organizing documents into folders. In the evening, I read a chapter of a book before making pasta for dinner. Then I watched a nature documentary until I felt sleepy.""",

    # 4: Mixed joy & sadness
    """We celebrated Dad’s birthday tonight. The table was filled with his favorite dishes, and he laughed the loudest when my cousin told a joke he’s heard a hundred times. I smiled, too, but every so often, I caught myself glancing at the empty chair across from him. Mom’s chair. This was the first birthday without her. We lit candles, sang loudly, and even took a group photo, but in every picture, I can’t help noticing the space beside Dad, like a shadow that wouldn’t leave.""",

    # 5: Calm melancholy without overt sadness cues
    """The park was almost empty today. A few leaves drifted down from the tall oak trees, landing softly on the path. I walked slowly, stopping now and then to watch the ripples on the pond. A couple sat on a bench, speaking quietly. I didn’t hear their words, only the rise and fall of their voices. The air was cool, and I could smell the faint scent of rain from earlier. I felt… not unhappy, not lonely, but something in between, like a gentle sigh.""",

    # 6: Fear without other emotions
    """The hallway was dark except for a faint light at the far end. I could hear the hum of the refrigerator in the kitchen, but it was drowned out by the sound of my own heartbeat. Every step forward felt heavier. Halfway down the hall, I thought I saw a shadow move — or maybe it was just my eyes playing tricks. My hands were cold. I reached for the light switch, but my fingers trembled so much I missed it twice before finally finding it."""
]



# Path to your fine-tuned model folder
MODEL_PATH = "./finetuned_emotion"

# Load tokenizer and model
tokenizer = AutoTokenizer.from_pretrained(MODEL_PATH)
model = AutoModelForSequenceClassification.from_pretrained(MODEL_PATH)

# Create a pipeline for inference
emotion_pipeline = pipeline(
    "text-classification",
    model=model,
    tokenizer=tokenizer,
    return_all_scores=True
)

# Run predictions on all journals
for i, journal in enumerate(stress_test_journals, start=1):
    print(f"\nJournal {i}: {journal}")
    results = emotion_pipeline(journal)
    for r in results[0]:
        print(f"{r['label']}: {r['score']:.4f}")
